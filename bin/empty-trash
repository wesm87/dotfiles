#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'

###
# Empty user Trash folder
###
function __dotfiles_empty_trash() {
  local -r all_flag="${1:-}"
  local -r linux_trash_path="$HOME/.local/share/Trash"

  if ! is-mac-os && ! is-linux-os; then
    log-message 'error' '[empty-trash]: only macOS and Linux are supported'
    exit 1
  fi

  if is-mac-os; then
    rm -rfv "$HOME"/.Trash/*

    if [ "$all_flag" = '--all-volumes' ]; then
      sudo rm -rfv /Volumes/*/.Trashes
    fi
  elif is-linux; then
    rm -rfv "$linux_trash_path"/files/* && rm -rf "$linux_trash_path"/info/*
  fi
}

__dotfiles_empty_trash "$@"
